<link rel="stylesheet" href="{{ STATIC_URL }}maps/css/leaflet.css" />
<div style="display:table-row; height:100%">
    <div id="map" style="width:100%; height:100%; min-width:500px; min-height: 640px;"></div>
</div>
<script src="{{ STATIC_URL }}maps/js/leaflet.js"></script>
<script src="{{ STATIC_URL }}maps/js/leaflet.polylineDecorator.js"></script>
<script src="{{ STATIC_URL }}maps/js/routeNodes.js"></script>
<script src="{{ STATIC_URL }}maps/js/voyagesMap.js"></script>
<script type="text/javascript">
var ports = {
    {% for place_name, data in regions.items %}
        "{{ place_name }}": new Port(new NamedPoint("{{ place_name }}", new L.LatLng({{ data.0 }}, {{ data.1 }}))),
    {% endfor %}
};
var flows = [
    {% for flow in flows.values %}
        new Flow('{{ flow.0 }}', '{{ flow.1 }}', Math.round({{ flow.2 }}), Math.round({{ flow.3 }})),
    {% endfor %}
];
voyagesMap.
    init('{{ map_year }}', '{{ STATIC_URL }}maps/', routeNodes).
    setMaxPathWidth(20).
    setPathOpacity(0.75);
voyagesMap.setNetworkFlow(ports, flows);
</script>