{% extends "voyage/voyagebase.html" %}
{% load sass_tags %}

<!-- Basic template for pages in the Voyage section -->
{% load i18n %}

{% block csslist %}
<link href="{% sass_src 'scss/navbar-site.scss' %}" rel="stylesheet" type="text/css" />
<link href="{% sass_src 'scss/main.scss' %}" rel="stylesheet" type="text/css" />
<link href="{% sass_src 'scss/trans.scss' %}" rel="stylesheet" type="text/css" />
<link href="{% sass_src 'scss/off-canvas.scss' %}" rel="stylesheet" type="text/css" />
<link href="{% sass_src 'scss/search-ui.scss' %}" rel="stylesheet" type="text/css" />
<link href="{% sass_src 'scss/library/select2.min.scss' %}" rel="stylesheet" type="text/css" />


{% endblock %}
{% block title %}{% trans 'Search The Voyages Database' %}{% endblock %}

{% block jslist %}
<script src="https://unpkg.com/vue"></script>
<script type="text/javascript" src="{{ STATIC_URL }}scripts/qtip/jquery.qtip.min.js"></script>
<script src="{{ STATIC_URL }}scripts/voyage/voyage-search.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}scripts/menu-aim.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}scripts/library/select2.min.js" type="text/javascript"></script>

{% endblock %}

{% block content %}
<div id="search-bar">
<!-- SearchNav -->
<nav class="navbar navbar-expand-xl navbar-dark bg-dark">
	<div class="nav-container">
		<!-- <a href="/" class="navbar-brand">Search</a> -->
		<button class="navbar-toggler float-right" type="button" data-toggle="collapse" data-target="#searchNav">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="navbar-collapse collapse" id="searchNav">
			<ul class="navbar-nav ">
				<li class="nav-item dropdown">
					<a class="nav-link" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Ship, Nation, Owner</a>
					<div class="">
						<ul class="dropdown-menu search-menu" id="shipNationOwner" role="menu">
								<li class="dropdown-item dropdown-item-li" data-submenu-id="vin">
									Voyage Identification Number
									<div id="vin" class="search-submenu popover">
											<h3 class="popover-title">Voyage Identification Number</h3>
											<div class="popover-content">

												<div class="form-group">
													<label for="form-vin">Voyage Identification Number</label>
													<input type="number" v-model="searchFilter.vin.current" id="form-vin" class="form-control">
												 </div>

												 <div class="form-group">
 													<p>VIN current is: <code>${ searchFilter.vin.current }</code></p>
													<p>VIN default is: <code>${ searchFilter.vin.default }</code></p>
													<p>VIN hasChanged is: <code>${ searchFilter.vin.hasChanged }</code></p>
 												 </div>

												 <button v-on:click="vinApply" v-bind:disabled="!searchFilter.vin.hasChanged" class="btn btn-primary btn-sm">Apply</button>
												 <button v-on:click="vinReset" v-bind:disabled="!searchFilter.vin.hasChanged" class="btn btn-outline-primary btn-sm">Reset</button>

											</div>
									</div>
								</li>

								<li class="dropdown-item dropdown-item-li" data-submenu-id="cdrom">
										Voyage in 1999 CD-ROM
										<div id="cdrom" class="search-submenu popover">
												<h3 class="popover-title">Voyage in 1999 CD-ROM</h3>
												<div class="popover-content">Image</div>
										</div>
								</li>

								<li class="dropdown-item dropdown-item-li" data-submenu-id="vessel">
										Vessel Name and Owners
										<div id="vessel" class="search-submenu popover">
												<h3 class="popover-title">Vessel Name and Owner</h3>
													<div class="form-group">
														<label for="form-vessel-name">Vessel Name</label>
														<input type="text" v-model="searchFilter.vesselName.current" id="form-vessel-name" class="form-control">
													</div>

												 <div class="form-group">
 													<label for="form-vessel-owner">Vessel Owner</label>
 													<input type="text" v-model="searchFilter.vesselOwner.current" id="form-vessel-owner" class="form-control">
 												 </div>

												 <div class="form-group">
													 <p>vesselName current is: <code>${ searchFilter.vesselName.current }</code></p>
 													<p>vesselName default is: <code>${ searchFilter.vesselName.default }</code></p>
 													<p>vesselOwner current is: <code>${ searchFilter.vesselOwner.current }</code></p>
													<p>vesselOwner default is: <code>${ searchFilter.vesselOwner.default }</code></p>
													<p>vessel hasChanged is: <code>${ searchFilter.vessel.hasChanged }</code></p>
 												 </div>

												 <button v-bind:disabled="!searchFilter.vessel.hasChanged" v-on:click="vesselApply" v-bind:disabled="!searchFilter.vessel.hasChanged" class="btn btn-primary btn-sm">Apply</button>
												 <button v-bind:disabled="!searchFilter.vessel.hasChanged" v-on:click="vesselReset" v-bind:disabled="!searchFilter.vessel.hasChanged" class="btn btn-outline-primary btn-sm">Reset</button>

										</div>
								</li>

								<li v-if="isAdvanced" class="dropdown-item dropdown-item-li" data-submenu-id="flag">
										Flag
										<div id="flag" class="search-submenu popover">
												<h3 class="popover-title">Flag</h3>
												<div class="popover-content">
													<select class="js-example-basic-multiple" id="form-flag" name="states[]" multiple="multiple">
													</select>
												</div>
										</div>
								</li>

								<li class="dropdown-item dropdown-item-li" data-submenu-id="construction">
										Construction and Registration
										<div id="construction" class="search-submenu popover">
												<h3 class="popover-title">Construction and Registration</h3>
												<div class="popover-content">Image</div>
										</div>
								</li>

								<li class="dropdown-item dropdown-item-li" data-submenu-id="rig">
										Rig, Tonnage
										<div id="rig" class="search-submenu popover">
												<h3 class="popover-title">Rig, Tonnage</h3>
												<div class="popover-content">Image</div>
										</div>
								</li>

								<li class="dropdown-item dropdown-item-li" data-submenu-id="gun">
										Guns Mounted
										<div id="gun" class="search-submenu popover">
												<h3 class="popover-title">Guns Mounted and Vessel Owners</h3>
												<div class="popover-content">Image</div>
										</div>
								</li>

							</ul>
					</div>
				</li>


				<li class="nav-item dropdown">
					<a class="nav-link" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
						Source
					</a>
					<div class="dropdown-menu">
						<a class="dropdown-item" href="">Menu Item</a>
						<a class="dropdown-item" href="">Menu Item</a>
						<a class="dropdown-item" href="">Menu Item</a>
						<a class="dropdown-item" href="">Menu Item</a>
						<a class="dropdown-item" href="">Menu Item</a>
						<div class="dropdown-divider"></div>
						<a class="dropdown-item" href="">Menu Item</a>
					</div>
				</li>

			</ul>

			<ul class="navbar-nav ml-auto ">
				<li class="nav-item dropdown">
					<a class="nav-link" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
						Cog
					</a>
					<div class="dropdown-menu dropdown-menu-right">
						<div>
							<input type="checkbox" id="checkbox" v-model="isAdvanced">
							<label for="checkbox">{{ isAdvanced }}</label>
						</div>
						<a class="dropdown-item" href="">Menu Item</a>
						<a class="dropdown-item" href="">Menu Item</a>
						<a class="dropdown-item" href="">Menu Item</a>
						<a class="dropdown-item" href="">Menu Item</a>
						<a class="dropdown-item" href="">Menu Item</a>
						<div class="dropdown-divider"></div>
						<a class="dropdown-item" href="">Menu Item</a>
					</div>
				</li>

				<li class="nav-item dropdown">
					<a class="nav-link" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
						?
					</a>
					<div class="dropdown-menu dropdown-menu-right">
						<a class="dropdown-item" href="#">English</a>
						<a class="dropdown-item" href="#">PortuguÃªs</a>
					</div>
				</li>

			</ul>
		</div>
	</div>
</nav><!-- End of SearchNav -->



<div class="container-new">
	<div class="row row-offcanvas row-offcanvas-right">

		<div class="col-md-12 col-lg-12 col-xs-12">
		<!-- <div class='col-md-4 col-xs-12 col-lg-3 sidebar-offcanvas' id="sidebar">
      <div class="sidebar-title-1"> sidebar </div>
    </div>
		<div class="col-md-8 col-xs-12 col-lg-9 ">
			<p class="hidden-md">
        <button type="button" class="btn btn-trans btn-sm" data-toggle="offcanvas">
          <div>
            <span class="fa fa-exchange" style=" vertical-align: middle;"></span>
            <span>Toggle Sidebar</span>
          </div>
        </button>
      </p> -->

			<!-- CurrentQuery -->
				<code>${searchQuery}</code>

			<!-- End of CurrentQuery -->

			<!-- Tabs -->
			<ul class="nav nav-tabs">
			  <li class="nav-item">
			    <a class="nav-link active" href="#" data-toggle="tab" data-target="#results">Results</a>
			  </li>
				<li class="nav-item">
			    <a class="nav-link" href="#" data-toggle="tab" data-target="#stats">Summary Statistics</a>
			  </li>
				<li class="nav-item">
			    <a class="nav-link" href="#">Tables</a>
			  </li>
				<li class="nav-item">
			    <a class="nav-link" href="#">Custom Graphs</a>
			  </li>
				<li class="nav-item">
			    <a class="nav-link" href="#">Timeline</a>
			  </li>
				<li class="nav-item">
			    <a class="nav-link" href="#">Maps</a>
			  </li>
				<li class="nav-item">
			    <a class="nav-link" href="#">Animation</a>
			  </li>

			  <li class="nav-item">
			    <a class="nav-link disabled" href="#">Disabled</a>
			  </li>
			</ul><!-- End of Tabs -->



			<!-- TabContainers -->
			<div id="tabsJustifiedContent" class="tab-content">
          <div id="results" class="tab-pane fade active show">
              Results
							<br/>
							<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
							<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
          </div>
          <div id="stats" class="tab-pane fade">
              Stats
          </div>
          <div id="messages1" class="tab-pane fade">
              Something else
          </div>
      </div>
			<!-- End of TabContainers -->
		</div>

	</div>
</div>



</div>


<style>
.popover {
	display: none;
}

</style>

<script>

$(document).ready(function() {
	$('#form-flag').select2({
		 width: '100%',
		 data: flagSet
	 });
});

var flagSet = [
	{id:0, text:'Spain', value:"1"},
	{id:1, text:'Uruguay', value:"1"},
	{id:2, text:'Portugal', value:"1"},
	{id:3, text:'Brazil', value:"1"},
	{id:4, text:'Great Britain', value:"1"},
	{id:5, text:'Netherlands', value:"1"},
	{id:6, text:'U.S.A', value:"1"},
	{id:7, text:'France', value:"1"},
	{id:8, text:'Denmark', value:"1"},
	{id:9, text:'Hanse Towns, Brandenburg', value:"1"},
	{id:10, text:'Sweden', value:"1"},
	{id:11, text:'Norway', value:"1"},
	{id:12, text:'Argentina', value:"1"},
	{id:13, text:'Russia', value:"1"},
	{id:14, text:'Sardinia', value:"1"},
	{id:15, text:'Mexico', value:"1"},
	{id:16, text:'Genoa', value:"1"},
	{id:17, text:'Duchy of Courland', value:"1"},
	{id:18, text:'Prussia', value:"1"},
	{id:19, text:'Bremen', value:"1"},
	{id:20, text:'Other', value:"1"}
]


		// Vue starts here
		var searchBar = new Vue({
			el: "#search-bar",
			delimiters: ['${', '}'],
			data: {
				text: "text",
				isAdvanced: true,
				searchFilter: {
					vin: {
						default: "",
						current: "",
						hasChanged: false,
					},
					vesselName: {
						default: "",
						current: "",
						hasChanged: false,
					},
					vesselOwner: {
						default: "",
						current: "",
						hasChanged: false,
					},
					vessel: {
						hasChanged: false,
					},
					flag: {
						default: "",
						current: "",
						hasChanged: false,
					},
					flagImputed: {
						default: "",
						current: "",
						hasChanged: false,
					},
				},
				searchQuery: {
					vin: {
						value: null
					},
					vesselName: {
						value: null
					},
					vesselOwner: {
						value: null
					},
					flag: {
						value: null
					},
					flagImputed: {
						value: null
					}
				}
			},
			watch: {
					isAdvanced: function(val){
						$menu.menuAim({
								activate: activateSubmenu,
								deactivate: deactivateSubmenu
						});
					},
					searchFilter: {
						handler: function(val){
							// voyage identification number
							val.vin.hasChanged = val.vin.default !== val.vin.current

							// vessel name
							val.vesselName.hasChanged = val.vesselName.default !== val.vesselName.current

							// vessel owner
							val.vesselOwner.hasChanged = val.vesselOwner.default !== val.vesselOwner.current

							// vessel
							val.vessel.hasChanged = val.vesselName.hasChanged || val.vesselOwner.hasChanged

							// flag
							val.flag.hasChanged = val.flag.default !== val.flag.current

							// flagImputed
							val.flagImputed.hasChanged = val.flagImputed.default !== val.flagImputed.current

						},
						deep: true,
				},
			},

			methods: {
				vinApply: function(val){
					this.searchQuery.vin.value = this.searchFilter.vin.current;
				},
				vinReset: function(val){
					this.searchFilter.vin.current = this.searchFilter.vin.default;
					this.searchQuery.vin.value = this.searchFilter.vin.default;
				},
				vesselApply: function(val){
					this.searchQuery.vesselName.value = this.searchFilter.vesselName.current;
					this.searchQuery.vesselOwner.value = this.searchFilter.vesselOwner.current;
				},
				vesselReset: function(val){
					this.searchFilter.vesselName.current = this.searchFilter.vesselName.default;
					this.searchFilter.vesselOwner.current = this.searchFilter.vesselOwner.default;
					this.searchQuery.vesselName.value = this.searchFilter.vesselName.default;
					this.searchQuery.vesselOwner.value = this.searchFilter.vesselOwner.default;
				}
			}

		})


		// MENU AIM //

		var $menu = $(".search-menu");

		// jQuery-menu-aim: <meaningful part of the example>
		// Hook up events to be fired on menu row activation.
		$menu.menuAim({
				activate: activateSubmenu,
				deactivate: deactivateSubmenu
		});

		// jQuery-menu-aim: </meaningful part of the example>

		// jQuery-menu-aim: the following JS is used to show and hide the submenu
		// contents. Again, this can be done in any number of ways. jQuery-menu-aim
		// doesn't care how you do this, it just fires the activate and deactivate
		// events at the right times so you know when to show and hide your submenus.
		function activateSubmenu(row) {
				var $row = $(row),
						submenuId = $row.data("submenuId"),
						$submenu = $("#" + submenuId),
						height = $menu.outerHeight(),
						width = $menu.outerWidth();

				var parentWidth = $row.width();

				// Show the submenu
				$submenu.css({
						display: "block",
						top: -1,
						left: parentWidth + 47 // main should overlay submenu
						// height: height - 4  // padding for main dropdown's arrow
				});

				// Keep the currently activated row's highlighted look
				$row.find("a").addClass("maintainHover");
		}

		function deactivateSubmenu(row) {
				var $row = $(row),
						submenuId = $row.data("submenuId"),
						$submenu = $("#" + submenuId);

				// Hide the submenu and remove the row's highlighted look
				$submenu.css("display", "none");
				$row.find("a").removeClass("maintainHover");
		}

		// Bootstrap's dropdown menus immediately close on document click.
		// Don't let this event close the menu if a submenu is being clicked.
		// This event propagation control doesn't belong in the menu-aim plugin
		// itself because the plugin is agnostic to bootstrap.
		$(".dropdown-menu li").click(function(e) {
				e.stopPropagation();
		});

		$(document).click(function() {
				// Simply hide the submenu on any click. Again, this is just a hacked
				// together menu/submenu structure to show the use of jQuery-menu-aim.
				$(".popover").css("display", "none");
				$("a.maintainHover").removeClass("maintainHover");
		});

</script>

{% endblock %}
